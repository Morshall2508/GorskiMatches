<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="bigiPadForChallengeHistory">
    <div class="navigationBar">
        <div id="homeButton">Home</div>
        <div id="accountPage">Account</div>
    </div>
    <div id="indexPadForChallengeHistory">
        <div id = "table"></div>
    </div>
</div>

<script type="module">
    import Auth from "/auth.js";

    fetch(`/api/challenge/challenges`)

        .then(res => {
            if (res.ok) { return res.json()};
            { throw "Not found";
            }
        })
            .then(json => {
            let html = "";
            json.forEach(item => {
            let scoreUser1 = item.registeredUserScore;
            let scoreUser2 = item.nonRegisteredUserScore;
            let timeUser2 = item.nonRegisteredUserTimeSeconds;
            let timeUser1 = item.registeredUserTimeSeconds;

                html += `<div class = "wrapperLeft">
                <div class = "listOfUUIDS"> ${item.uuid}</div>
                <div class = "header"> Quiz</div>
                <div class = "header"> Answer</div>
                <div class = "header"> Score</div>
                </div>`

                item.challengeQuizzes.forEach (innerItem => {

                    if (timeUser2 === 0) {
                    html += `<div class = "wrapper">
                        <div class = "column"><div class = "rest"> ${innerItem.quiz} </div></div>
                        <div class = "column"><div class = "rest"> ${innerItem.answerUser1} </div></div>
                        <div class = "column"><div class = "rest"> ${innerItem.scoreUser1} </div></div>
                        </div>`
                    } else {

                    if (scoreUser1>scoreUser2){
                        html += `<div class = "wrapper">
                        <div class = "column" style = "background-color:#54af54"><div class = "rest"> ${innerItem.quiz} </div></div>
                        <div class = "column" style = "background-color:#54af54"><div class = "rest"> ${innerItem.answerUser1} </div></div>
                        <div class = "column" style = "background-color:#54af54"><div class = "rest"> ${innerItem.scoreUser1} </div></div>
                        </div>`
                        } else {
                        html += `<div class = "wrapper">
                        <div class = "column" style = "background-color:#d54545"><div class = "rest"> ${innerItem.quiz} </div></div>
                        <div class = "column" style = "background-color:#d54545"><div class = "rest"> ${innerItem.answerUser1} </div></div>
                        <div class = "column" style = "background-color:#d54545"><div class = "rest"> ${innerItem.scoreUser1} </div></div>
                        </div>`
                    }
                }
        })
    })
    document.getElementById("table").innerHTML = html;
})

</script>
<script>
    document.getElementById("accountPage").onclick = () => {
        window.location.replace("/account.html?")
    };
</script>
<script>
    document.getElementById("homeButton").onclick = () => {
        window.location.replace("/")
    };
</script>
</body>
</html>